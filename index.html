<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Privacy Policy Generator</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        background: #f7f7f9;
      }
      header {
        background: #333;
        color: #fff;
        padding: 1rem;
        text-align: center;
      }
      main {
        max-width: 900px;
        margin: 2rem auto;
        background: #fff;
        padding: 2rem;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }
      section {
        margin-top: 1.5rem;
        border-top: 1px solid #eee;
        padding-top: 1rem;
      }
      section:first-of-type {
        border-top: none;
        padding-top: 0;
      }
      h2 {
        margin-bottom: 0.5rem;
        font-size: 1.2rem;
        color: #333;
      }
      label {
        font-weight: bold;
        display: block;
        margin-top: 1rem;
      }
      input[type="text"] {
        width: 100%;
        padding: 0.5rem;
        font-size: 1rem;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
        margin-top: 0.25rem;
      }
      button {
        margin-top: 1.5rem;
        background: #0069d9;
        color: #fff;
        border: none;
        padding: 0.75rem 1.5rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 1rem;
      }
      button:hover {
        background: #0053ba;
      }
      #result {
        margin-top: 1.5rem;
        white-space: pre-wrap;
        background: #f0f0f0;
        padding: 1rem;
        border: 1px solid #ddd;
        border-radius: 4px;
        max-height: 400px;
        overflow-y: auto;
        display: none;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Privacy Policy Generator</h1>
    </header>
    <main>
      <p>
        Use this form to generate a privacy policy based on your answers. Fill out
        the sections below and click <strong>Generate</strong>. The completed policy will
        display on the page and download as a PDF.
      </p>
      <form id="policyForm">
        <section>
          <h2>Company Info</h2>
          <label for="companyName">What is your company name?</label>
          <input type="text" id="companyName" name="companyName" required />
          <label for="companyLocation">Where is your company based?</label>
          <input type="text" id="companyLocation" name="companyLocation" />
          <label for="companyWebsite">Company website?</label>
          <input type="text" id="companyWebsite" name="companyWebsite" />
          <label for="ceoName">CEO name?</label>
          <input type="text" id="ceoName" name="ceoName" />
        </section>

        <section>
          <h2>DPO & Contacts</h2>
          <label for="dpoName">Do you have a Data Protection Officer? If so, name?</label>
          <input type="text" id="dpoName" name="dpoName" />
          <label for="dpoEmail">DPO email?</label>
          <input type="text" id="dpoEmail" name="dpoEmail" />
          <label for="dpoLocation">DPO location?</label>
          <input type="text" id="dpoLocation" name="dpoLocation" />
          <label for="privacyEmail">Privacy contact email?</label>
          <input type="text" id="privacyEmail" name="privacyEmail" />
          <label for="ukRep">Data Protection Representative in UK?</label>
          <input type="text" id="ukRep" name="ukRep" />
        </section>

        <section>
          <h2>Types of Data</h2>
          <label for="dataSubjects">Who are your data subjects?</label>
          <input type="text" id="dataSubjects" name="dataSubjects" />
          <label for="dataCategories">What categories of personal data do you process?</label>
          <input type="text" id="dataCategories" name="dataCategories" />
        </section>

        <section>
          <h2>Legal Basis</h2>
          <label for="legalBasis">What is your legal basis for processing data?</label>
          <input type="text" id="legalBasis" name="legalBasis" />
        </section>

        <section>
          <h2>Retention/Disposal</h2>
          <label for="retentionPeriod">How long do you retain personal data?</label>
          <input type="text" id="retentionPeriod" name="retentionPeriod" />
          <label for="disposalMethod">How do you dispose of data?</label>
          <input type="text" id="disposalMethod" name="disposalMethod" />
        </section>

        <section>
          <h2>Data Transfers</h2>
          <label for="transferOutsideEU">Do you transfer data outside the EU/EEA?</label>
          <input type="text" id="transferOutsideEU" name="transferOutsideEU" />
          <label for="transferSafeguards">What safeguards?</label>
          <input type="text" id="transferSafeguards" name="transferSafeguards" />
        </section>

        <section>
          <h2>Subprocessors/Vendors</h2>
          <label for="useVendors">Do you use vendors/subprocessors?</label>
          <input type="text" id="useVendors" name="useVendors" />
          <label for="vendorManagement">How do you select and monitor them?</label>
          <input type="text" id="vendorManagement" name="vendorManagement" />
        </section>

        <section>
          <h2>Rights Requests</h2>
          <label for="rightsExercise">How can people exercise their data rights?</label>
          <input type="text" id="rightsExercise" name="rightsExercise" />
        </section>

        <section>
          <h2>Supervisory Authority</h2>
          <label for="complaintEscalation">How can people escalate complaints?</label>
          <input type="text" id="complaintEscalation" name="complaintEscalation" />
          <label for="supervisoryAuthority">Which authority?</label>
          <input type="text" id="supervisoryAuthority" name="supervisoryAuthority" />
        </section>

        <section>
          <h2>IT Systems</h2>
          <label for="itSystems">What are the main systems/repositories for personal data?</label>
          <input type="text" id="itSystems" name="itSystems" />
        </section>

        <section>
          <h2>Versioning</h2>
          <label for="policyOwner">Who is responsible for the policy?</label>
          <input type="text" id="policyOwner" name="policyOwner" />
          <label for="approvalDate">Approval date?</label>
          <input type="text" id="approvalDate" name="approvalDate" />
          <label for="version">Version?</label>
          <input type="text" id="version" name="version" />
        </section>

        <button type="submit">Generate</button>
      </form>
      <div id="result"></div>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
      async function loadTemplate() {
        const response = await fetch('policy-template.txt');
        return await response.text();
      }

      function replacePlaceholders(text, replacements) {
        let output = text;
        for (const key in replacements) {
          const regex = new RegExp(`\\[${key}\\]`, 'g');
          output = output.replace(regex, replacements[key] || '');
        }
        return output;
      }

      document.getElementById('policyForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const formData = new FormData(e.target);
        const replacements = {
          'COMPANY_NAME': formData.get('companyName').trim(),
          'COMPANY_LOCATION': formData.get('companyLocation').trim(),
          'COMPANY_WEBSITE': formData.get('companyWebsite').trim(),
          'CEO_NAME': formData.get('ceoName').trim(),
          'DPO_NAME': formData.get('dpoName').trim(),
          'DPO_EMAIL': formData.get('dpoEmail').trim(),
          'DPO_LOCATION': formData.get('dpoLocation').trim(),
          'PRIVACY_EMAIL': formData.get('privacyEmail').trim(),
          'UK_REP': formData.get('ukRep').trim(),
          'DATA_SUBJECTS': formData.get('dataSubjects').trim(),
          'DATA_CATEGORIES': formData.get('dataCategories').trim(),
          'LEGAL_BASIS': formData.get('legalBasis').trim(),
          'RETENTION_PERIOD': formData.get('retentionPeriod').trim(),
          'DISPOSAL_METHOD': formData.get('disposalMethod').trim(),
          'TRANSFER_OUTSIDE_EU': formData.get('transferOutsideEU').trim(),
          'TRANSFER_GUARDS': formData.get('transferSafeguards').trim(),
          'USE_VENDORS': formData.get('useVendors').trim(),
          'VENDOR_MANAGEMENT': formData.get('vendorManagement').trim(),
          'RIGHTS_EXERCISE': formData.get('rightsExercise').trim(),
          'COMPLAINT_ESCALATION': formData.get('complaintEscalation').trim(),
          'SUPERVISORY_AUTHORITY': formData.get('supervisoryAuthority').trim(),
          'IT_SYSTEMS': formData.get('itSystems').trim(),
          'POLICY_OWNER': formData.get('policyOwner').trim(),
          'APPROVAL_DATE': formData.get('approvalDate').trim(),
          'VERSION': formData.get('version').trim(),
        };

        const template = await loadTemplate();
        const filled = replacePlaceholders(template, replacements);

        const resultDiv = document.getElementById('result');
        resultDiv.textContent = filled;
        resultDiv.style.display = 'block';

        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        const lines = doc.splitTextToSize(filled, 180);
        doc.text(lines, 10, 10);
        doc.save('privacy_policy.pdf');
      });
    </script>
  </body>
</html>
